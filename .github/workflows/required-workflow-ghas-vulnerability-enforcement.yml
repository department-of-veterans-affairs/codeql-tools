name: Enforce
on:
  pull_request: {}
permissions:
  contents: read
  pull-requests: write
  security-events: read
jobs:
  verify:
    name: Verify CodeQL Usage
    runs-on: ubuntu-latest
    steps:
      - name: Validate CodeQL Usage
        uses: department-of-veterans-affairs/codeql-tools/verify-codeql-usage@main
        with:
          message_violation: |
            Your repository is not in compliance with OIS requirements for CodeQL usage.

            Your repository contains **{highAlerts} high severity** vulnerabilities and **{criticalAlerts} critical severity** vulnerabilities.
            
            Per OIS policy, your repository must remediate critical and high vulnerabilities before you may merge additional source code changes. If this Pull Request remediates vulnerabilities, after your Pull Requests CodeQL scan completes, please re-trigger validation by clicking the `Re-run all jobs` button in the top-right corner at this link: <place link here>. Once validation reruns, you will be able to merge your Pull Request.
            
            For additional information about OIS policy, please refer to the OIS SWA Wiki: https://department-of-veterans-affairs.github.io/ois-swa-wiki/docs/ghas/codeql-usage
